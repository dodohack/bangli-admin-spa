<editor-page-header [slug]="'topic'"
                    [name]="'专题'"
                    [zh]="zh"
                    [previewUrl]="previewUrl"
                    [ids]="idsCurPage$ | async"
                    [entities]="entities$ | async"
                    [entity]="entity$ | async"
                    (cancelEdit)="cancelSave()">
</editor-page-header>


<entity-buttons [entityState]="(entity$ | async)?.state"
                (save)="save()"
                (save2Pending)="save2Pending()"
                (save2Draft)="save2Draft()"
                (save2Publish)="save2Publish()"
                (cancelSave)="cancelSave()">
</entity-buttons>

<entity-title-date [title]="(entity$ | async)?.title"
                   (titleChange)="updateTitle($event)">
</entity-title-date>

<!-- Topic location, category, tag, topic etc -->

<entity-attr-cloud [categories]="(entity$ | async)?.categories"
                   [locations]="(entity$ | async)?.locations"
                   (toggle)="openPanel = !openPanel"
                   (deleteCat)="removeCat($event)"
                   (deleteTag)="removeTag($event)"
                   (toggleGeoLocation)="updateGeoLocation($event)">
</entity-attr-cloud>

<entity-attributes [editorId]="(entity$ | async)?.editor_id"
                   [channelId]="(entity$ | async)?.channel_id"
                   [editors]="editors$ | async"
                   [channels]="cmsChannels$ | async"
                   (editorChanged)="updateEditor($event)"
                   (channelChanged)="updateChannel($event)">
</entity-attributes>

<!-- Froala Editor -->
<!-- TODO: Use official one when ngModule bug is fixed -->
<!--<div *ngIf="inputPost" [froalaEditor]="froalaOptions"
     [(froalaModel)]="inputPost.content"></div>-->

<froala [froalaOptions]="froalaOptions"
        [froalaData]="content$ | async"
        (model)="contentChanged($event)"></froala>

<!-- Right panel, we can trigger a seperate saving individually -->
<right-panel [width]="'400px'" [isOpen]="openPanel"
             (toggle)="openPanel = !openPanel">
    <tabset>
        <tab heading="分类">
            <div class="treeview">
                <category-tree [parentId]="0"
                               [channelId]="(entity$ | async)?.channel?.id"
                               [categories]="cmsCategories$ | async"
                               [selectedCats]="(entity$ | async)?.categories"
                               (checkEvent)="updateCat($event)">
                </category-tree>
            </div>
        </tab>

        <tab heading="Location">
            <geo-location-cloud [locations]="geoLocations$ | async"
                                (clickEvent)="updateGeoLocation($event)">
            </geo-location-cloud>
        </tab>
    </tabset>
</right-panel>

<pre>
    This page should have following entries:
    1. cms topic related stuff
    2. Manage cms post related to this topic
    3. Manage deal post related to this topic
    4. Manage topic deal content of this topic, we have auto generated template
       for this, such as xxx的优惠, xxx折扣, xxx打折信息
    5. deal topic option is default enabled for topic in shopping category, so
       at least we have placeholder page stands for search engine ranking, as
       we will automatically generate deal post for deal topic.
</pre>
<h2>This is topic</h2>
