<table class="table table-hover entity-list">
    <thead class="thead-default">
    <tr>
        <th width="2%"></th>
        <th width="2%">
            <input type="checkbox" name="sa"
                   [ngModel]="isAllSelected" (change)="updateAll()">
        </th>
        <th width="36%">
            <div class="form-inline">
                <div class="form-group" style="margin-right: 2rem">
                    <select class="form-control form-control-sm custom-select"
                            [(ngModel)]="batchAction" [disabled]="!canEdit">
                        <option value="" selected disabled>批量操作</option>
                        <option value="edit">批量修改</option>
                        <option value="offline_edit">离线编辑</option>
                        <option value="lock">批量锁定</option>
                        <option value="delete">移到回收站</option>
                    </select>

                    <button class="btn btn-sm btn-default" [disabled]="!canEdit"
                            (click)="submitBatchAction()">应用</button>
                </div>
                <span>标题</span>
            </div>
        </th>
        <th width="16%">作者 / 编辑</th>
        <th width="18%">分类</th>
        <th width="12%">
            <span *ngIf="isPost">发布日期</span><span *ngIf="!isPost">创建时间</span>
        </th>
        <th width="12%">更新日期</th>
        <th width="6%">view</th>
    </tr>
    </thead>

    <tbody>

    <!-- table row of cms entities -->
    <template ngFor let-id [ngForOf]="ids" let-i="index">
        <tr>
            <th>{{i+1}}</th>
            <td><input type="checkbox" name="p[]" [ngModel]="isEditing(id)"
                       (change)="updateEditList(id)"></td>
            <!-- Enable fast editing if double click on title column -->
            <td (dblclick)="batchEdit.emit([id])">
                <!-- Badge: Locked post -->
                <i class="fa fa-lock" style="color: red" *ngIf="entities[id].lock"></i>
                <!-- Badge: Online edit lock -->
                <span class="tag tag-default-outline"
                      *ngIf="hasActivity(id) && getActivity(id).edit_lock == 1">
                    <i class="fa fa-pencil" style="color: red"></i>
                    {{ authors[getActivity(id).user_id].name }} 正在编辑
                </span>
                <!-- Badge: Offline edit lock -->
                <span class="tag tag-default-outline"
                      *ngIf="hasActivity(id) && getActivity(id).edit_lock == 2">
                    <i class="fa fa-pencil" style="color: blue"></i>
                    {{ authors[getActivity(id).user_id].name }} 正在离线编辑
                </span>

                <span *ngIf="entities[id].state != 'publish'" class="tag tag-danger-outline">
                    {{ zh[entities[id].state] }}
                </span>
                <span class="tag tag-default-outline">{{ zh[entities[id].creative_type] }}</span>

                <!-- Title -->
                <strong><a [routerLink]="[editLink(id)]">{{ entities[id].title }}</a></strong>

                <div class="row-actions">
                    <span class="trash"><a>删除</a> | </span>
                    <span><a href="{{ previewLink(id) }}" target="_blank">查看</a> | </span>
                    <span>双击快速编辑</span>
                </div>
            </td>

            <td>
                <span *ngIf="hasEditor(entities[id].editor_id)">
                    编辑: {{ editorName(entities[id].editor_id) }}
                </span>
                <div *ngIf="hasAuthor(entities[id].author_id)">
                    作者: {{ authorName(entities[id].author_id) }}
                </div>
            </td>

            <td>
                <span *ngFor="let cat of entities[id].categories">
                <a [routerLink]="['/cms/category', cat.id]">{{ cat.name }}</a>, </span>
            </td>
            <td>
                <span *ngIf="isPost">{{ entities[id].published_at }}</span>
                <span *ngIf="!isPost">{{ entities[id].created_at }}</span>
            </td>
            <td>{{ entities[id].updated_at }}</td>
            <td>
                <span>0</span>
                <div><span>0</span></div> <!-- Comments -->
            </td>
        </tr>
    </template>

    </tbody>
</table>
